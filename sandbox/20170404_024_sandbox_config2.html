<!doctype html>
<head><meta charset="UTF-8"><title>sandbox</title>
<style>
ol {margin:0; width:300px; font-size:12px; vertical-align:middle;}
</style>

</head>
<body>
<nav><header>sandbox　コンフィグ画面</header></nav>
<!-- ****1**** ****2**** ****3**** ****4**** ****5**** ****6**** ****7*****  -->
----
<div id="output"></div>
----
<div id="config_html"></div>
----<BR>
<pre><code class=”prettyprint” >
</code></pre>
<textarea id="config_html_text" rows="50" cols="150""></textarea><BR>

----

<script>
HJN = {};
HJN.utils = {};
HJN.utils.Config = (function() {
	/* constructor */
	function Config(prefix, ol){ 
		if(!(this instanceof Config)) return new Config(prefix, ol);
		this._pre = (prefix || '') + "_";			// 各フィールド、要素の名称のプレフィックス
		this._ols = ol ? '<' + ol + '>' : '<ol>'; 	// リストに使用する要素（初期値 ol )
		this._ole = ol ? '</' + ol + '>' : '</ol>';
		this._html = this._ols;	// config設定画面のHtml
		this._nameHtml = '';	// HTMLタグの name属性指定
		this._name = '';		// radioのConfig.get用
	}

	/* static member */
	var proto = Config.prototype = {
			_config : {}	// config設定コンテナ
	};
	/* class method */
	// configのkey(prefix+nameかid)に画面から指定された値を設定する
	Config.on = function(t) {	// HTML要素の値が変更した時に呼ばれる処理
		var radio1 = document.getElementById("r1"),
			output = document.getElementById("output");
		console.log(t);
		output.innerHTML = "type[" + t.type + "] name[" + t.name + "] id[" + t.id + "] value[" + t.value + "]";

		if (t.type === "radio") {	// radioのとき、nameに対して、選択されたid(文字列)を登録
			this.prototype._config[t.name] = t.id;
		} else {	// text,numberのとき、idに対して、value(入力値)を登録
			this.prototype._config[t.id] = t.value;
		}
	};

	
	/* private */
/*	proto._helperLabelEnd = function　(name, id, val, attribute, sLabel) {
		return	name +
				'id="' + this._pre + '_' + id + '" '　+
				'onchange="HJN.utils.Config.on(this);" ' +
				(val ? 'value="' + val + '" ' : '') +
				(attribute || '') + '>' +
				(sLabel ? sLabel : '') +
				'<label>\n';
	};
*/	
	/* public */
	proto.getHtml = function() {	// config設定用HTMLテキストを出力する
		return this._html + this._ole;
	};

	proto.get = function(key) {	// key(name(radioのとき)もしくはid)の設定値を取得する
		return this._config[this._pre + key];
	};
	
	proto.set = function(key, val) {	// keyに値を設定する
		this.value[this._pre + key] = val;
	};

	
	proto.n = function () {	// 改行　
		this._html += this._ole + this._ols;
		return this;
	};
	proto.nDown = function () {	// ネスト一つ下げ　
		this._html += this._ols;
		return this;
	};
	proto.nUp = function () {	// ネスト一つ上げ　
		this._html += this._ole;
		return this;
	};

	proto.name = function (str) {	// nameを変更する（radio等の先頭で指定）
		this._nameHtml = str ? 'name="' + this._pre + str + '" ' : '';
		this._name = str;
		return this;
	};

	proto.label = function (id, str, attribute) {	// ラベル要素 (idは関連付けるformのid属性)
		this._html += '<label ' +
						(id ? 'for="' + this._pre + id + '" '　: '') +
						(attribute || '') + '>' +
						(str || '') +
						'<label>\n';
		return this;
	};

	proto.labeledForm = function (id, type, typedAttribute, 	// ラベル付された各種入力フォーム
								pLabel, sLabel, val, attribute, check) {
		this._html += '<label>' +
					(pLabel ? pLabel : '') +
					'<input type="' +　type + '" ' +
						(typedAttribute || '') + 
						this._nameHtml +
						'id="' + this._pre + id + '" '　+
						'onchange="HJN.utils.Config.on(this);" ' +
						(val ? 'value="' + val + '" ' : '') +
						(attribute || '') + 
						(check ? ' checked="checked;"' : '') +
					'>' +
					(sLabel ? sLabel : '') +
					'<label>\n';
		// デフォルト指定があるとき configにデフォルト値を設定する
		if (type === "radio" && check) {	// radioのとき、nameに対して、選択されたid(文字列)を登録
			proto._config[this._pre + this._name] = id;
		} else {	// text,numberのとき、idに対して、val(入力値)を登録
			proto._config[this._pre + id] = val;
		}
		return this;
	};

	proto.number = function (id, pLabel, sLabel, val, attribute) {	// テキストボックス要素で、文字列を設定
		proto.labeledForm.call(this, id, "number", "", 
								pLabel, sLabel, val, attribute);
		return this;
	};
	proto.text = function (id, pLabel, sLabel, val, attribute) {	// テキストボックス要素で、数値を設定
		proto.labeledForm.call(this, id, "text", "", 
								pLabel, sLabel, val, attribute);
		return this;
	};
	proto.radio = function (id, pLabel, sLabel, check, attribute) {	// ラジオボタン要素で、選択肢の一つを設定
		proto.labeledForm.call(this, id, "radio", (check ? 'checked="checked;"' : ''),
								pLabel, sLabel, "", attribute, check);
		return this;
	};

	/* new */
	return Config;
}());



var conf = HJN.utils.Config("m")
	.name("rg1").label("","---[Line feed code]---").n()
		.radio("r1","","Fixed Length")
			.number("r1num","","byte","80",'style="width:50px;"').n()
		.radio("r2","","Windows:CR(13)+LF(10)",true).n()
		.radio("r3","","zOS:NEL(15)").n()
		.radio("r4","","Mac:CR(13)").n()
		.radio("r5","","other[charcode]").n()
	.label("","---").n()
	.name("rg2").label("","---[CSV delimiter]---").n()
		.radio("r1","","comma",true)
		.radio("r2","","tab")
		.radio("r3","","other[char]")
			.text("r3t","","",",",'size="2" placeholder=","').n()
	.label("","---").n()
	.name("rg3").label("","---[Time stamp field]---").n()
		.number("t1","from","byte of ","1",'style="width:50px;"')
		.number("t2","","column","1",'style="width:50px;"').n()
		.radio("r1","","text")
			.text("r1t","[","]","",'size="22" placeholder="YYYY/MM/DD hh.mm.ss.sss"').n()
		.radio("r2","","Julius date [unit:",true)
			.name("rg3r21")
				.radio("r1","","msec",true)
				.radio("r2","","sec]").n()
			.nDown()
			.name("rg3r22")
				.radio("r1","","full number column").n()
				.radio("r2","","")
					.number("r4n","","bytes number","4",'style="width:50px;"').n()
				.radio("r3","","long(4byte)").n()
			.nUp()
	.label("","---").n()
	.name("rg4").label("","---[TAT(Turnaround time) field]---").n()
		.number("t1","from","byte of ","1",'style="width:50px;"')
		.number("t2","","column","1",'style="width:50px;"').n()
		.nDown().label("","* Set column 1 for fixed format:").nUp().n()
	.name("rg5")
		.label("","unit:")
		.radio("r1","","msec")
		.radio("r2","","sec",true).n()
	.name("rg6")
		.radio("r1","","Column value",true).n()
		.radio("r2","","")
			.number("r4n","","bytes number","4",'style="width:50px;"').n()
		.radio("r3","","long(4byte)").n()
		.radio("r4","","other[char]")
			.text("r4num","","",",",'size="2" placeholder=","').n()
	;

html = conf.getHtml()
</script>

<script>
var output = document.getElementById("output");
var config_html = document.getElementById("config_html");
var config_html_text = document.getElementById("config_html_text");

config_html.innerHTML = html;
config_html_text.innerHTML = html;

</script>

</body>
